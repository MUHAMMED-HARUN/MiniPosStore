# دليل إضافة عناصر الطلب

## نظرة عامة

تم تطوير نظام متكامل لإضافة وإدارة عناصر الطلب في النظام. يتضمن النظام الواجهات التالية:

### 1. الواجهات المطورة

#### أ. صفحة تعديل الطلب (`Save.cshtml`)
- عرض تفاصيل الطلب الأساسية
- زر لإضافة عناصر جديدة
- عرض قائمة العناصر الموجودة
- إحصائيات الطلب (المبلغ الإجمالي، المدفوع، المتبقي)

#### ب. Modal إضافة عنصر (`_AddOrderItem.cshtml`)
- نموذج لإضافة عنصر جديد
- اختيار المنتج من قائمة منسدلة
- إدخال الكمية وسعر البيع
- عرض معلومات المنتج المختار
- حساب المبلغ الإجمالي للعنصر تلقائياً

#### ج. قائمة العناصر (`_OrderItemsList.cshtml`)
- جدول يعرض جميع عناصر الطلب
- إمكانية تعديل وحذف العناصر
- عرض تفاصيل كل عنصر (المنتج، الكمية، السعر، المبلغ الإجمالي)

### 2. الملفات المضافة/المعدلة

#### Controllers
- `OrdersController.cs`: إضافة دوال `AddItem`, `GetOrderItems`, `GetProductInfo`

#### Views
- `Save.cshtml`: تحديث الصفحة لتتضمن زر إضافة العناصر
- `_AddOrderItem.cshtml`: Modal جديد لإضافة العناصر
- `_OrderItemsList.cshtml`: Partial View لعرض قائمة العناصر

#### CSS
- `orders.css`: ملف تنسيقات مخصص لصفحات الطلبات

### 3. آلية العمل

#### أ. إضافة عنصر جديد:
1. المستخدم يضغط على زر "إضافة عنصر جديد"
2. يفتح Modal مع نموذج إضافة العنصر
3. المستخدم يختار المنتج من القائمة المنسدلة
4. يتم تحميل معلومات المنتج تلقائياً (السعر، الكمية المتوفرة، الوحدة)
5. المستخدم يدخل الكمية وسعر البيع
6. يتم حساب المبلغ الإجمالي للعنصر تلقائياً
7. عند الضغط على "إضافة العنصر"، يتم إرسال البيانات عبر AJAX
8. يتم إغلاق Modal وإعادة تحميل قائمة العناصر

#### ب. عرض العناصر:
1. يتم تحميل العناصر عبر AJAX عند فتح الصفحة
2. عرض العناصر في جدول منظم
3. إمكانية حذف العناصر مباشرة
4. تحديث الإحصائيات تلقائياً

#### ج. حذف العناصر:
1. المستخدم يضغط على زر الحذف
2. تأكيد الحذف عبر رسالة تأكيد
3. إرسال طلب حذف عبر AJAX
4. إعادة تحميل قائمة العناصر

### 4. المميزات

#### أ. واجهة مستخدم متقدمة:
- تصميم متجاوب (Responsive)
- ألوان وأيقونات واضحة
- رسائل تأكيد وتنبيه
- Toast notifications للرسائل

#### ب. وظائف ذكية:
- تحميل معلومات المنتج تلقائياً
- حساب المبالغ تلقائياً
- التحقق من صحة البيانات
- معالجة الأخطاء

#### ج. أداء محسن:
- استخدام AJAX لتجنب إعادة تحميل الصفحة
- تحميل البيانات بشكل ديناميكي
- تحديث جزئي للمحتوى

### 5. كيفية الاستخدام

#### للمستخدم:
1. انتقل إلى صفحة الطلبات
2. اختر طلب موجود أو أنشئ طلب جديد
3. اضغط على "إضافة عنصر جديد"
4. اختر المنتج وأدخل الكمية والسعر
5. اضغط "إضافة العنصر"
6. كرر العملية لإضافة المزيد من العناصر

#### للمطور:
1. تأكد من وجود المنتجات في النظام
2. تأكد من صحة البيانات في قاعدة البيانات
3. يمكن تخصيص التصميم عبر ملف `orders.css`
4. يمكن إضافة ميزات جديدة مثل تعديل العناصر

### 6. المتطلبات التقنية

#### Frontend:
- jQuery
- Bootstrap 5
- Font Awesome (للأيقونات)

#### Backend:
- ASP.NET Core MVC
- Entity Framework Core
- BAL/DAL Architecture

### 7. الأمان

- التحقق من صحة البيانات (Model Validation)
- حماية من CSRF (Anti-Forgery Token)
- التحقق من صلاحيات المستخدم
- معالجة آمنة للأخطاء

### 8. التطوير المستقبلي

#### ميزات مقترحة:
- تعديل العناصر الموجودة
- نسخ عناصر من طلب آخر
- خصومات على العناصر
- طباعة فاتورة الطلب
- إشعارات عند نفاد المخزون

#### تحسينات تقنية:
- استخدام SignalR للتحديثات المباشرة
- تحسين الأداء عبر Caching
- إضافة Unit Tests
- تحسين UX عبر Animations

---

**ملاحظة**: هذا النظام مصمم ليكون سهل الاستخدام وقابل للتطوير والتخصيص حسب احتياجات المشروع.

